<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
        <title>Carbon - A simple PHP API extension for DateTime.</title>
        <meta name="description" content="Carbon - A simple PHP API extension for DateTime.">
        <link href='//fonts.googleapis.com/css?family=Open+Sans:400,300,600' rel='stylesheet' type='text/css'>
        <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css" rel="stylesheet">
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/tomorrow-night.min.css">
        <link href="/carbon.css" rel="stylesheet">
        <script>
            (function (i, s, o, g, r, a, m) {
                i['GoogleAnalyticsObject'] = r;
                i[r] = i[r] || function () {
                    (i[r].q = i[r].q || []).push(arguments)
                }, i[r].l = 1 * new Date();
                a = s.createElement(o),
                    m = s.getElementsByTagName(o)[0];
                a.async = 1;
                a.src = g;
                m.parentNode.insertBefore(a, m)
            })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

            ga('create', 'UA-27020320-3', 'auto');
            ga('send', 'pageview');

        </script>
    </head>
    <body data-spy="scroll" data-target="#affix-nav">

    <div class="main-wrapper">
        <aside id="reference">
            <div class="search-wrapper">
                <div class="search-bar">
                    <div class="input-group">
                        <span class="input-group-addon">
                            <i class="glyphicon glyphicon-search"></i>
                        </span>
                        <input type="text" class="form-control" placeholder="Search" id="search-filter">
                    </div>
                    <button class="close">&lt;</button>
                </div>
                <div class="search"></div>
            </div>
        </aside>
        <section>
            <nav class="navbar navbar-default navbar-static-top">
                <div class="container">
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar"
                                aria-expanded="false" aria-controls="navbar">
                            <span class="sr-only">Toggle navigation</span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                        <a class="navbar-brand" href="/"><img src="/logo.png" alt="Carbon" width="159" height="50"></a>
                    </div>
                    <div id="navbar" class="navbar-collapse collapse">
                        <ul class="nav navbar-nav">
                            <li><a href="/#gettingstarted">Getting Started</a></li>
                            <li><a href="/docs/">Docs</a></li>
                            <li><a href="#reference">Reference</a></li>
                            <li><a href="/history/">History</a></li>
                            <li><a href="/contribute/">Contribute</a></li>
                            <li><a href="//github.com/briannesbitt/carbon">GitHub</a></li>
                        </ul>
                    </div>
                </div>
            </nav>

            

            <div class="container page">
                <div class="row">
                    <div class="col-md-9">
                        <h1>How to Contribute to this documentation</h1>

<p>This documentation use commands to <b>lint</b> sample source codes, <b>execute</b> and inject the
    actual results of examples into a generated doc.</p>

<blockquote>
    <p>Don't make changes to the <code>[a-z]+.html</code> files directly!!</p>
</blockquote>

<p>Change the associated <code>[a-z]+.src.html</code> and then use the <code>generate.php</code> script to generate the
    new <code>[a-z]+.html</code> file. It can be run at the command line using <code>php generate.php</code> from the
    project root when in the <code>gh-pages</code> branch. Maybe someday I'll extract this out to another project or at
    least run it with a post receive hook, but for now its just a local tool, deal with it.</p>

<p>The commands are quickly explained below. To see some examples you can view the raw <code>docs/index.src.html</code>
    file in this repo.</p>

<h2>{{::lint()}}</h2>

<p>The <code>lint</code> command is meant for confirming the code is valid and will <code>eval()</code> the code passed
    into the function. Assuming there were no errors, the executed source code will then be injected back into the text
    replacing out the <code>{{::lint()}}</code>. When you look at the raw <code>docs/index.src.html</code> you will see
    that the code can span several lines. Remember the code is executed in the context of the running script so any
    variables will be available for the rest of the file.</p>

<p>
<pre><code>{{::lint($var = 'brian nesbitt';)}} => $var = 'brian nesbitt';</code></pre></p>

<blockquote>
    <p>As mentioned the <code>$var</code> can later be echo'd and you would get 'brian nesbitt' as all of the source is
        executed in the same scope.</p>
</blockquote>

<h2>{{::exec()}} and {{eval}}</h2>

<p>The <code>exec</code> command begins by performing an <code>eval()</code> on the code passed into the function. The
    executed source code will then be injected back into the text replacing out the <code>{{varName::exec()}}</code>.
    This will also create a variable named <code>varName_eval</code> that you can then place anywhere in the file and it
    will get replaced with the output of the <code>eval()</code>. You can use any type of output (<code>echo</code>,
    <code>printf</code>, <code>var_dump</code> etc) statement to return the result value as an output buffer is setup to
    capture the output. As a shortcut, you also can use simply <code>{{::exec()}}</code> with no varName then display
    the last executed result with <code>{{eval}}</code>.</p>

<p>
<pre><code>{{::exec(echo $var;)}} => echo $var;
{{eval}} => brian nesbitt  // $var is still set from above
{{exVarName_eval}} => 2 // named eval can be display before the execution or after many other executions
{{exVarName::exec(echo 2;)}} => echo 2;
{{::exec(echo 3;)}}
{{otherName::exec(echo 4;)}}
{{exVarName_eval}} => 2 // no matter where it's positioned, it always refers to exVarName::exec result
</pre></code></p>

<h2>/*pad()*/</h2>

<p>The <code>pad()</code> is a special source modifier. This will pad the code block to the indicated number of
    characters using spaces. Its particularly handy for aligning <code>//</code> comments when showing results.</p>

<p>
<pre><code>{{exVarName1::exec(echo 12345;/*pad(20)*/)}} // {{exVarName1_eval}}
{{exVarName2::exec(echo 6;/*pad(20)*/)}} // {{exVarName2_eval}}
</pre></code></p>

<p>... would generate to:</p>

<p>
<pre><code>echo 12345;          // 12345
echo 6;              // 6
</pre></code></p>

<p>Apart from the docs the typical steps can be used to contribute your own improvements.</p>

<ul>
    <li>Fork</li>
    <li>Clone</li>
    <li>PHPUnit</li>
    <li>Branch</li>
    <li>PHPUnit</li>
    <li>Code</li>
    <li>PHPUnit</li>
    <li>Commit</li>
    <li>Push</li>
    <li>Pull request</li>
    <li>Relax and play Castle Crashers</li>
</ul>

                    </div>
                    
                </div>
            </div>
        </section>
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
    <script>

        var callbacks = {};
        var $document = $(document);
        var editorAutoLoad = false;

        function transformEditor($pre, index, code, token, link) {
            $pre.removeClass('live-editor').addClass('live-editor-loading');
            if (!code) {
                code = $pre.find('code').text();
                token = 'live-editor-' + index;
                link = 'https://try-carbon.herokuapp.com/?hide-output-gutter&output-left-padding=10&theme=tomorrow_night&border=none&radius=4&v-padding=15&input=' +
                    encodeURIComponent(code) +
                    '&token=' + token;
                $('<a href="' + link + '" target="_blank" class="live-editor-new-window"><i class="glyphicon glyphicon-new-window"></i></a>').insertBefore($pre);
            }
            var $iframe = $('<iframe src="' + link +
                '&embed" style="width: 100%; border: none; opacity: 0; pointer-events: none; position: absolute;"></iframe>').insertAfter($pre);
            (callbacks[token] || (callbacks[token] = {})).ready = function () {
                $iframe.css({
                    opacity: 1,
                    pointerEvents: 'all',
                    position: '',
                    height: $pre.outerHeight() + 'px',
                });
                $pre.hide();
            };
        }

        function scrollCheck() {
            $('.live-editor').each(function (index) {
                var $pre = $(this);
                if (!editorAutoLoad) {
                    var code = $pre.find('code').text();
                    var token = 'live-editor-' + index;
                    var link = 'https://try-carbon.herokuapp.com/?hide-output-gutter&output-left-padding=10&theme=tomorrow_night&border=none&radius=4&v-padding=15&input=' +
                        encodeURIComponent(code) +
                        '&token=' + token;
                    $pre.css('cursor', 'pointer').click(function () {
                        transformEditor($pre, index, code, token, link);
                    });
                    $('<a href="' + link + '" target="_blank" class="live-editor-new-window"><i class="glyphicon glyphicon-new-window"></i></a>').insertBefore($pre);

                    return;
                }

                var scrollTop = $document.scrollTop();
                var scrollBottom = scrollTop + $(window).height();
                var viewMargin = 400;
                var top = $pre.offset().top;
                if (top + $pre.outerHeight() + viewMargin > scrollTop && top - viewMargin < scrollBottom) {
                    transformEditor($pre, index);
                }
            });
        }

        function openDoc(selection)
        {
            if (/[a-zA-Z0-9_-]+$/.test(selection)) {
                $.each(['Carbon', 'CarbonInterval', 'CarbonPeriod'], function (index, className) {
                    var element = $('#doc-method-' + className + '-' + selection)[0];
                    if (element) {
                        $('#search-filter').val('');
                        refreshDoc();
                        $('.main-wrapper').addClass('open');
                        element.scrollIntoView();

                        return false;
                    }
                });
            }
        }

        $(document)
            .on('click', 'a[data-open-doc]', function (event) {
                event.preventDefault();
                event.stopPropagation();

                openDoc($(event.target).data('open-doc'));
            })
            .on('click', '[data-slide-down]', function (event) {
                event.preventDefault();
                event.stopPropagation();

                $($(event.target).data('slide-down')).slideToggle();
            })
        ;

        function refreshDoc()
        {
            var search = $('#search-filter').val().toLowerCase();
            $('.doc-method').each(function () {
                var $method = $(this);
                $method[~$method.find('h2:first').text().toLowerCase().indexOf(search) ? 'show' : 'hide']();
            });
        }

        $('#search-filter').on('keyup change input', refreshDoc);

        window.addEventListener('message', function (event) {
            var data = event.data;
            if (typeof data === 'string') {
                data = JSON.parse(data);
            }
            if (data && data.sender === 'try-carbon') {
                switch (data.event) {
                    case 'ready':
                        var callback = (callbacks[data.token] || {})[data.event];
                        if (typeof callback === 'function') {
                            callback();
                        }
                        break;
                    case 'input':
                        // data.input
                        break;
                    case 'selection':
                        openDoc(data.selection);
                        break;
                }
            }
        });

        scrollCheck();
        $document.scroll(scrollCheck);

        $('.search-wrapper .close').click(function () {
            $('.main-wrapper').removeClass('open');
        });

        $('code').on('mouseup select dblclick', function () {
            var s = window.getSelection();
            if ((s.anchorOffset || s.anchorOffset === 0) && s.focusOffset && s.anchorOffset + 1 < s.focusOffset) {
                openDoc(s.anchorNode.wholeText.substring(s.anchorOffset, s.focusOffset));
            }
        });

        $('[href="#reference"]').click(function (event) {
            event.preventDefault();
            if ($('.main-wrapper').toggleClass('open').hasClass('open')) {
                $('#search-filter').focus();
            }
        });

        $(function () {
            $.ajax('/reference/', {
                success: function (data) {
                    $('.search').html(data);
                },
            });
        });

    </script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
</body>
</html>
